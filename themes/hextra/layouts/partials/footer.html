{{- $enableFooterSwitches := .Scratch.Get "enableFooterSwitches" | default false -}}
{{- $displayThemeToggle := site.Params.theme.displayToggle | default true -}}
{{- $footerSwitchesVisible := and $enableFooterSwitches (or hugo.IsMultilingual $displayThemeToggle) -}}
{{- $copyrightSectionVisible := or (.Site.Params.footer.displayPoweredBy | default true) .Site.Params.footer.displayCopyright -}}

{{- $logoPath := .Site.Params.navbar.logo.path | default "images/logo.svg" -}}
{{- $logoLink := .Site.Params.navbar.logo.link | default .Site.Home.RelPermalink -}}
{{- $logoWidth := .Site.Params.navbar.logo.width | default "30" -}}
{{- $logoHeight := .Site.Params.navbar.logo.height | default "30" -}}
{{- $logoDarkPath := .Site.Params.navbar.logo.dark | default $logoPath -}}

{{- $showFooterLogo := .Site.Params.footer.showLogo | default false -}}
{{- $showFooterNav := .Site.Params.footer.showNavLinks | default false -}}
{{- $showFooterSocial := .Site.Params.footer.showSocialMedia | default false -}}
{{- $showFooterCopyright := .Site.Params.footer.showCopyright | default false -}}
{{- $showFooterWave := .Site.Params.footer.showWave | default true -}}

<footer class="hextra-footer hx-pt-8">
  <!-- Wave SVG -->
  {{- if $showFooterWave -}}
  <div class="footer-waves">
    <svg class="footer-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
      </defs>
      <g class="parallax">
        <use class="wave" xlink:href="#gentle-wave" x="48" y="0" fill="rgba(243,244,246, 0.7)" />
        <use class="wave" xlink:href="#gentle-wave" x="48" y="3" fill="rgba(243,244,246, 0.5)" />
        <use class="wave" xlink:href="#gentle-wave" x="48" y="5" fill="rgba(243,244,246, 0.3)" />
        <use class="wave" xlink:href="#gentle-wave" x="48" y="7" fill="#e8e9eb" />
      </g>
    </svg>
  </div>
  {{- end -}}

  <div class="footer-container mx-auto">
    <div class="footer-content hx-flex hx-flex-col md:hx-flex-row hx-justify-between hx-items-center hx-py-4 hx-pt-12">
      <!-- Logo Section -->
      {{- if $showFooterLogo -}}
      <div class="logo-section hx-flex hx-justify-center hx-items-center hx-mb-6 md:hx-mb-0">
        <a href="{{ .Site.Home.RelPermalink }}">
          <img class="hx-block dark:hx-hidden" src="{{ $logoPath | relURL }}" alt="Logo" height="50" width="50" />
          <img class="hx-hidden dark:hx-block" src="{{ $logoDarkPath | relURL }}" alt="Logo" height="50" width="50" />
        </a>
      </div>
      {{- end -}}

      <!-- Navigation Links Section -->
      {{- if $showFooterNav -}}
      <div class="footer-nav-links hx-flex hx-flex-wrap hx-justify-center hx-gap-8 hx-mb-6 md:hx-mb-0">
        {{ $links := slice
          (dict "url" "/"              "text" "home")
          (dict "url" "/about"         "text" "about")
          (dict "url" "/about/contact" "text" "contact")
          (dict "url" "/articles"      "text" "articles")
          (dict "url" "/roadmap"      "text" "roadmap")
          (dict "url" "/checklists"    "text" "checklists")
          (dict "url" "/news"          "text" "news")
          (dict "url" "https://shop.beginnerprivacy.com" "text" "shop")
          (dict "url" "/about/legal-disclaimer" "text" "disclaimer")
        }}

        {{ range $links }}
          {{ $translated := T .text }}
          {{ $href := .url }}
          {{ if not (strings.HasPrefix $href "http") }}
            {{ $href = (relLangURL .url) }}
          {{ end }}
          <a href="{{ $href }}" class="hx-text-black dark:hx-text-white">
            {{ $translated }}
          </a>
        {{ end }}
      </div>
      {{- end -}}

      <!-- Social Media Section -->
      {{- if $showFooterSocial -}}
      <div class="social-media hx-flex hx-flex-wrap hx-justify-center hx-gap-4">
        <a href="https://codeberg.org/BeginnerPrivacy" title="Codeberg" target="_blank" rel="noopener noreferrer" class="hx-text-black dark:hx-text-white">
          {{ partial "utils/icon.html" (dict "name" "codeberg" "attributes" "height=24") }}
        </a>
        <a href="https://github.com/BeginnerPrivacy" title="GitHub" target="_blank" rel="noopener noreferrer" class="hx-text-black dark:hx-text-white">
          {{ partial "utils/icon.html" (dict "name" "github" "attributes" "height=24") }}
        </a>
        <a href="https://mastodon.social/@BeginnerPrivacy" target="_blank" title="Mastodon" rel="noopener noreferrer" class="hx-text-black dark:hx-text-white">
          {{ partial "utils/icon.html" (dict "name" "mastodon" "attributes" "height=24") }}
        </a>
        <a href='{{ "about/join-simplex-group" | relLangURL }}' target="_blank" title="SimpleX Chat" rel="noopener noreferrer" class="hx-text-black dark:hx-text-white ">
          {{ partial "utils/icon.html" (dict "name" "simplex" "attributes" "height=24") }}
        </a>
      </div>
    </div>
    {{- end -}}
    <!-- Divider Line -->
    {{- if or $showFooterNav $showFooterLogo $showFooterSocial $showFooterCopyright -}}
    <hr class="hx-border-black/5 dark:hx-border-white/10 hx-my-2" />
    {{- end -}}

    <!-- Copyright Section -->
    {{- if $showFooterCopyright -}}
    <div class="copyright-section hx-text-center hx-text-black dark:hx-text-white hx-py-4">
      <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener noreferrer">CC BY-SA 4.0 </a>{{- T "copyright" -}}<strong>&nbsp;<a href="/about/privacy-policy"> {{- T "privacyNotice" -}}</a></strong></p>
    </div>
    {{- end -}}
  </div>
</footer>